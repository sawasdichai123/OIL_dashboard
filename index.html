<!DOCTYPE html>
<html lang="th" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚õΩ OilInfo Premium ‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;600;700;800&display=swap');

        :root{
            --glass-bg: rgba(15,23,42,.65);
            --accent: #38bdf8;
            --energy-green: #00C853;
            --dark-emerald: #006644;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Space Grotesk', sans-serif;
        }

        body {
            min-height: 100vh;
            background: #0a0e1a;
            color: #e2e8f0;
            overflow-x: hidden;
        }

        .bg-canvas{
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
        }

        .gradient-orb{
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            animation: float 20s ease-in-out infinite;
        }

        .orb-1{
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(56,189,248,0.6) 0%, transparent 70%);
            top: -10%;
            left: -10%;
        }

        .orb-2{
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(0,200,83,0.5) 0%, transparent 70%);
            top: 20%;
            right: -5%;
            animation-delay: -7s;
        }

        .orb-3{
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(167,139,250,0.4) 0%, transparent 70%);
            bottom: -15%;
            left: 30%;
            animation-delay: -14s;
        }

        @keyframes float{
            0%, 100%{ transform: translate(0, 0) scale(1); }
            33%{ transform: translate(50px, -50px) scale(1.1); }
            66%{ transform: translate(-30px, 30px) scale(0.9); }
        }

        .content-wrapper{
            position: relative;
            z-index: 1;
        }

        .navbar{
            backdrop-filter: blur(20px);
            background: rgba(15,23,42,.6);
            border-bottom: 1px solid rgba(148,163,184,.2);
            padding: 1rem 0;
        }

        .navbar-brand{
            font-size: 28px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #e2e8f0;
            text-decoration: none;
        }

        .badge-soft{
            background: linear-gradient(135deg, rgba(0,200,83,.2), rgba(56,189,248,.2));
            color: #7dd3fc;
            border: 1px solid rgba(56,189,248,.4);
            animation: pulse-glow 3s ease-in-out infinite;
            padding: 0.35rem 0.65rem;
            border-radius: 12px;
            font-size: 0.75rem;
        }

        @keyframes pulse-glow{
            0%, 100%{ box-shadow: 0 0 10px rgba(56,189,248,.3); }
            50%{ box-shadow: 0 0 20px rgba(56,189,248,.6); }
        }

        .glass-card{
            background: var(--glass-bg);
            border: 1px solid rgba(148,163,184,.3);
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(2,6,23,.5);
            border-radius: 24px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card:hover{
            transform: translateY(-4px);
            box-shadow: 0 30px 80px rgba(2,6,23,.6);
        }

        .container {
            max-width: 1400px;
            padding: 20px;
        }

        .hero {
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
        }

        .hero h1 {
            font-size: 48px;
            font-weight: 800;
            background: linear-gradient(135deg, #e2e8f0 0%, #00C853 30%, #38bdf8 60%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: gradient-shift 8s ease infinite;
            margin-bottom: 15px;
        }

        @keyframes gradient-shift{
            0%, 100%{ background-position: 0% 50%; }
            50%{ background-position: 100% 50%; }
        }

        .update-time {
            display: inline-block;
            background: linear-gradient(135deg, var(--energy-green), var(--dark-emerald));
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0,200,83,.3);
        }

        .price-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .price-card {
            padding: 25px;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(56,189,248,.08) 0%, rgba(0,200,83,.08) 100%);
            border: 1px solid rgba(148,163,184,.2);
            transition: all 0.3s;
            position: relative;
        }

        .price-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--energy-green), #38bdf8);
        }

        .price-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,200,83,.25);
        }

        .price-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .price-card h3 {
            color: var(--energy-green);
            font-size: 20px;
            font-weight: 700;
        }

        .fuel-icon {
            font-size: 32px;
        }

        .price-main {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(135deg, #e2e8f0, var(--energy-green));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin: 15px 0;
        }

        .price-unit {
            font-size: 16px;
            color: #94a3b8;
            font-weight: normal;
        }

        .price-change {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
        }

        .price-up {
            background: rgba(239,68,68,.15);
            color: #fca5a5;
            border: 1px solid rgba(239,68,68,.3);
        }

        .price-down {
            background: rgba(0,200,83,.15);
            color: var(--energy-green);
            border: 1px solid rgba(0,200,83,.3);
        }

        .price-stable {
            background: rgba(148,163,184,.15);
            color: #94a3b8;
            border: 1px solid rgba(148,163,184,.3);
        }

        .section {
            padding: 40px;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, #e2e8f0, var(--energy-green));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 25px;
            border-left: 5px solid var(--energy-green);
            padding-left: 15px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 14px 24px;
            background: rgba(15,23,42,.6);
            border: 1px solid rgba(148,163,184,.2);
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            color: #cbd5e1;
        }

        .tab:hover {
            border-color: rgba(0,200,83,.4);
            transform: translateY(-2px);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--energy-green), var(--dark-emerald));
            color: white;
            box-shadow: 0 10px 30px rgba(0,200,83,.4);
        }

        .table-wrapper {
            overflow-x: auto;
            border-radius: 16px;
            background: rgba(15,23,42,.4);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th {
            background: linear-gradient(135deg, var(--energy-green), var(--dark-emerald));
            color: white;
            padding: 16px;
            text-align: left;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 13px;
        }

        .comparison-table td {
            padding: 16px;
            border-bottom: 1px solid rgba(148,163,184,.1);
            color: #cbd5e1;
        }

        .comparison-table tbody tr:hover {
            background: rgba(0,200,83,.1);
        }

        .brand-logo {
            font-weight: 800;
            color: var(--energy-green);
            font-size: 16px;
        }

        .chart-container {
            height: 400px;
            margin-top: 20px;
            padding: 20px;
            background: rgba(15,23,42,.4);
            border-radius: 16px;
        }

        .world-prices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .world-price-card {
            background: rgba(15,23,42,.4);
            border: 1px solid rgba(148,163,184,.2);
            padding: 24px;
            border-radius: 16px;
            text-align: center;
            transition: all 0.3s;
        }

        .world-price-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,200,83,.2);
        }

        .world-price-card h4 {
            color: var(--energy-green);
            margin-bottom: 12px;
            font-size: 18px;
            font-weight: 700;
        }

        .world-price-card .price {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #e2e8f0, #38bdf8);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
        }

        .error {
            background: rgba(239,68,68,.15);
            border: 1px solid rgba(239,68,68,.3);
            padding: 20px;
            border-radius: 12px;
            color: #fca5a5;
            text-align: center;
        }

        @media (max-width: 768px) {
            .hero h1 { font-size: 32px; }
            .price-cards { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="bg-canvas">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <div class="content-wrapper">
        <nav class="navbar navbar-expand-lg">
            <div class="container-xl">
                <a class="navbar-brand" href="#">
                    <span>üõ¢Ô∏è</span>
                    <span>OilInfo</span>
                    <span class="badge badge-soft ms-2">LIVE</span>
                </a>
            </div>
        </nav>

        <div class="container">
            <div class="hero glass-card">
                <h1>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</h1>
                <p>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</p>
                <span class="update-time" id="updateTime">üïê ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
            </div>

            <div id="priceCardsContainer" class="price-cards">
                <div class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
            </div>

            <section class="section glass-card">
                <h2 class="section-title">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏≤‡∏°‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå</h2>
                <div class="tabs">
                    <button class="tab active" onclick="app.showFuelType('gasoline', this)">‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô</button>
                    <button class="tab" onclick="app.showFuelType('gasohol', this)">‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå</button>
                    <button class="tab" onclick="app.showFuelType('diesel', this)">‡∏î‡∏µ‡πÄ‡∏ã‡∏•</button>
                </div>
                <div class="table-wrapper">
                    <table class="comparison-table" id="priceTable">
                        <tbody>
                            <tr><td colspan="4" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <div class="section glass-card">
                <h2 class="section-title">‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</h2>
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </div>

            <div class="section glass-card">
                <h2 class="section-title">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÇ‡∏•‡∏Å</h2>
                <div class="world-prices" id="worldPricesContainer">
                    <div class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // API Configuration
        const API_CONFIG = {
            baseURL: 'YOUR_AWS_API_ENDPOINT_HERE',
            endpoints: {
                prices: '/prices',
                brands: '/brands',
                history: '/history',
                world: '/world-prices'
            },
            headers: {
                'Content-Type': 'application/json',
                // 'Authorization': 'Bearer YOUR_API_KEY' // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ API Key
            }
        };

        // Main Application
        const app = {
            data: {
                prices: {},
                brands: {},
                history: {},
                worldPrices: {}
            },
            chart: null,

            async init() {
                try {
                    await this.fetchAllData();
                    this.renderPriceCards();
                    this.renderBrandComparison('gasoline');
                    this.renderChart();
                    this.renderWorldPrices();
                    this.startAutoRefresh();
                } catch (error) {
                    this.showError(error);
                }
            },

            async fetchAllData() {
                // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API - ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏° structure ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á API
                const [prices, brands, history, world] = await Promise.all([
                    this.fetchAPI(API_CONFIG.endpoints.prices),
                    this.fetchAPI(API_CONFIG.endpoints.brands),
                    this.fetchAPI(API_CONFIG.endpoints.history),
                    this.fetchAPI(API_CONFIG.endpoints.world)
                ]);

                this.data.prices = prices;
                this.data.brands = brands;
                this.data.history = history;
                this.data.worldPrices = world;
            },

            async fetchAPI(endpoint) {
                // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ API ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ mock data
                if (API_CONFIG.baseURL === 'YOUR_AWS_API_ENDPOINT_HERE') {
                    return this.getMockData(endpoint);
                }

                const response = await fetch(`${API_CONFIG.baseURL}${endpoint}`, {
                    headers: API_CONFIG.headers
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                return await response.json();
            },

            getMockData(endpoint) {
                // Mock data ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö demo
                const mockData = {
                    '/prices': {
                        gasoline95: { price: 38.42, change: -0.20 },
                        gasoline91: { price: 35.67, change: 0.15 },
                        gasohol95: { price: 36.89, change: 0 },
                        gasohol91: { price: 34.12, change: -0.30 },
                        e20: { price: 32.55, change: -0.25 },
                        e85: { price: 28.90, change: 0.10 },
                        dieselB7: { price: 32.44, change: -0.18 },
                        dieselB20: { price: 31.89, change: -0.22 },
                        updatedAt: new Date().toISOString()
                    },
                    '/brands': {
                        gasoline: [
                            { brand: 'PTT', g95: 38.42, g91: 35.67 },
                            { brand: 'Shell', g95: 38.50, g91: 35.75 },
                            { brand: 'Bangchak', g95: 38.38, g91: 35.62 }
                        ],
                        gasohol: [
                            { brand: 'PTT', gh95: 36.89, gh91: 34.12, e20: 32.55 },
                            { brand: 'Shell', gh95: 36.95, gh91: 34.18, e20: 32.60 }
                        ],
                        diesel: [
                            { brand: 'PTT', b7: 32.44, b20: 31.89 },
                            { brand: 'Shell', b7: 32.50, b20: 31.95 }
                        ]
                    },
                    '/history': {
                        labels: ['1 ‡∏ï.‡∏Ñ.', '8 ‡∏ï.‡∏Ñ.', '15 ‡∏ï.‡∏Ñ.', '22 ‡∏ï.‡∏Ñ.', '29 ‡∏ï.‡∏Ñ.', '5 ‡∏û.‡∏¢.', '6 ‡∏û.‡∏¢.'],
                        gasoline95: [39.50, 39.20, 38.90, 38.75, 38.60, 38.62, 38.42],
                        gasohol95: [37.80, 37.50, 37.25, 37.10, 36.95, 37.09, 36.89],
                        dieselB7: [33.20, 33.00, 32.80, 32.65, 32.55, 32.62, 32.44]
                    },
                    '/world-prices': {
                        wti: { price: 75.42, change: 1.2 },
                        brent: { price: 79.15, change: 0.8 },
                        dubai: { price: 77.80, change: -0.5 },
                        thb: { price: 34.85, change: 0 }
                    }
                };
                return mockData[endpoint] || {};
            },

            renderPriceCards() {
                const { prices } = this.data;
                const container = document.getElementById('priceCardsContainer');
                
                const fuelTypes = [
                    { key: 'gasoline95', name: '‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô 95', icon: '‚õΩ' },
                    { key: 'gasoline91', name: '‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô 91', icon: '‚õΩ' },
                    { key: 'gasohol95', name: '‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå 95', icon: 'üåø' },
                    { key: 'gasohol91', name: '‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå 91', icon: 'üåø' },
                    { key: 'e20', name: '‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå E20', icon: 'üåø' },
                    { key: 'e85', name: '‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå E85', icon: 'üåæ' },
                    { key: 'dieselB7', name: '‡∏î‡∏µ‡πÄ‡∏ã‡∏• B7', icon: 'üöõ' },
                    { key: 'dieselB20', name: '‡∏î‡∏µ‡πÄ‡∏ã‡∏• B20', icon: 'üöõ' }
                ];

                container.innerHTML = fuelTypes.map(fuel => {
                    const data = prices[fuel.key];
                    const changeClass = data.change > 0 ? 'price-up' : data.change < 0 ? 'price-down' : 'price-stable';
                    const changeIcon = data.change > 0 ? '‚ñ≤' : data.change < 0 ? '‚ñº' : '‚óè';
                    const changeText = data.change !== 0 ? `${data.change.toFixed(2)} ‡∏ö‡∏≤‡∏ó` : '‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á';

                    return `
                        <div class="price-card">
                            <div class="price-card-header">
                                <h3>${fuel.name}</h3>
                                <span class="fuel-icon">${fuel.icon}</span>
                            </div>
                            <div class="price-main">${data.price.toFixed(2)} <span class="price-unit">‡∏ö‡∏≤‡∏ó/‡∏•‡∏¥‡∏ï‡∏£</span></div>
                            <span class="price-change ${changeClass}">${changeIcon} ${changeText}</span>
                        </div>
                    `;
                }).join('');

                // Update timestamp
                const date = new Date(prices.updatedAt);
                document.getElementById('updateTime').textContent = `üïê ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${date.toLocaleString('th-TH')}`;
            },

            showFuelType(type, el) {
                // remove active from all tabs and mark the clicked element active (if provided)
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                if (el && el.classList) el.classList.add('active');
                this.renderBrandComparison(type);
            },

            renderBrandComparison(type) {
                const brands = this.data.brands[type] || [];
                const table = document.getElementById('priceTable');

                let headers, rows;
                if (type === 'gasoline') {
                    headers = ['‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå', '‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô 95', '‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô 91', '‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢'];
                    rows = brands.map(b => [b.brand, b.g95, b.g91, ((b.g95 + b.g91) / 2).toFixed(2)]);
                } else if (type === 'gasohol') {
                    headers = ['‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå', '‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå 95', '‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå 91', 'E20', '‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢'];
                    rows = brands.map(b => [b.brand, b.gh95, b.gh91, b.e20, ((b.gh95 + b.gh91 + b.e20) / 3).toFixed(2)]);
                } else {
                    headers = ['‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå', '‡∏î‡∏µ‡πÄ‡∏ã‡∏• B7', '‡∏î‡∏µ‡πÄ‡∏ã‡∏• B20', '‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢'];
                    rows = brands.map(b => [b.brand, b.b7, b.b20, ((b.b7 + b.b20) / 2).toFixed(2)]);
                }

                table.innerHTML = `
                    <thead><tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr></thead>
                    <tbody>${rows.map(r => `
                        <tr>
                            ${r.map((c, i) => i === 0 ? `<td><span class="brand-logo">${c}</span></td>` : 
                                i === r.length - 1 ? `<td><strong>${c}</strong></td>` : 
                                `<td>${c}</td>`).join('')}
                        </tr>
                    `).join('')}</tbody>
                `;
            },

            renderChart() {
                const { history } = this.data;
                const ctx = document.getElementById('priceChart').getContext('2d');

                if (this.chart) this.chart.destroy();

                this.chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: history.labels,
                        datasets: [
                            {
                                label: '‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô 95',
                                data: history.gasoline95,
                                borderColor: '#667eea',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: '‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå 95',
                                data: history.gasohol95,
                                borderColor: '#00C853',
                                backgroundColor: 'rgba(0, 200, 83, 0.1)',
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: '‡∏î‡∏µ‡πÄ‡∏ã‡∏• B7',
                                data: history.dieselB7,
                                borderColor: '#FF9800',
                                backgroundColor: 'rgba(255, 152, 0, 0.1)',
                                tension: 0.4,
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#cbd5e1' } }
                        },
                        scales: {
                            y: { ticks: { color: '#94a3b8' } },
                            x: { ticks: { color: '#94a3b8' } }
                        }
                    }
                });
            },

            renderWorldPrices() {
                const { worldPrices } = this.data;
                const container = document.getElementById('worldPricesContainer');

                const items = [
                    { key: 'wti', flag: 'üá∫üá∏', name: 'WTI Crude', unit: '‡∏ï‡πà‡∏≠‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏•' },
                    { key: 'brent', flag: 'üá¨üáß', name: 'Brent Crude', unit: '‡∏ï‡πà‡∏≠‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏•' },
                    { key: 'dubai', flag: 'üá¶üá™', name: 'Dubai Crude', unit: '‡∏ï‡πà‡∏≠‡∏ö‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏•' },
                    { key: 'thb', flag: 'üí±', name: '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô', unit: '‡∏ö‡∏≤‡∏ó/‡∏î‡∏≠‡∏•‡∏•‡∏≤‡∏£‡πå' }
                ];

                container.innerHTML = items.map(item => {
                    const data = worldPrices[item.key];
                    const changeClass = data.change > 0 ? 'price-up' : data.change < 0 ? 'price-down' : 'price-stable';
                    const changeIcon = data.change > 0 ? '‚ñ≤' : data.change < 0 ? '‚ñº' : '‚óè';
                    const changeText = data.change !== 0 ? `${data.change > 0 ? '+' : ''}${data.change}%` : '0.0%';

                    return `
                        <div class="world-price-card">
                            <h4>${item.flag} ${item.name}</h4>
                            <div class="price">${item.key === 'thb' ? data.price.toFixed(2) : ' + data.price.toFixed(2)}</div>
                            <div class="currency" style="color: #94a3b8; font-size: 14px; margin-top: 5px;">${item.unit}</div>
                            <span class="price-change ${changeClass}" style="margin-top: 10px;">${changeIcon} ${changeText}</span>
                        </div>
                    `;
                }).join('');
            },

            startAutoRefresh() {
                // Auto refresh every 5 minutes
                setInterval(() => {
                    this.fetchAllData().then(() => {
                        this.renderPriceCards();
                        this.renderBrandComparison(this.getCurrentFuelType());
                        this.renderChart();
                        this.renderWorldPrices();
                    });
                }, 300000); // 5 minutes
            },

            getCurrentFuelType() {
                const activeTab = document.querySelector('.tab.active');
                const text = activeTab.textContent;
                if (text.includes('‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô')) return 'gasoline';
                if (text.includes('‡πÅ‡∏Å‡πä‡∏™‡πÇ‡∏ã‡∏Æ‡∏≠‡∏•‡πå')) return 'gasohol';
                return 'diesel';
            },

            showError(error) {
                console.error('Error:', error);
                const containers = ['priceCardsContainer', 'worldPricesContainer'];
                containers.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                        el.innerHTML = `
                            <div class="error">
                                <strong>‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</strong><br>
                                ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                            </div>
                        `;
                    }
                });
            }
        };
    

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });
    </script>
</body>
</html>
